= = = = = = = = = = = = = = = = = = = =
## Starting Time: 09-12 17:09:13
Namespace(dataset='ultratool', llm='Mistral-7B', llm_model_path='', seed=0, device='cuda:0', max_txt_length=512, max_ans_length=512, gnn_in_dim=1024, gnn_hidden_dim=1024, gnn_output_dim=4096, n_layers=2, gnn_type='SAGE', max_degree=300, max_nodes=23, num_epochs=2, batch_size=6, eval_batch_size=6, patience=2, lr=1e-05, wd=0.05, output_dir='output', grad_steps=4, name='graph_fp32')

[Training Data] # Chain Samples 3000 (100.00)
[Data Split] # Train 3000  # Test 500
# Train 2400   # Val 600   # Test 500
Loading checkpoint shards: 100%|███████████████████████████████| 3/3 [00:01<00:00,  2.11it/s]
Finish loading pre-trained Mistral-7B model!
Trainable params 10492928 || all params 7252225024 || trainable% 0.14469
/nas/home/ktshim/tool/pool/graphtoken/../utils/datautil.py:24: RuntimeWarning: divide by zero encountered in power
  d_inv = np.power(row_sum, -0.5).flatten()
/nas/home/ktshim/tool/pool/graphtoken/../utils/datautil.py:19: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:654.)
  return torch.sparse.FloatTensor(index, data, torch.Size(coo.shape))
  0%|                                                                | 0/800 [00:00<?, ?it/s]/home/ktshim/anaconda3/envs/tool/lib/python3.9/site-packages/torch/_inductor/compile_fx.py:236: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/nas/home/ktshim/tool/pool/graphtoken/glm_graph.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  0%|                                                     | 1/800 [00:45<10:10:56, 45.88s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_graph.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  0%|▏                                                    | 2/800 [01:53<13:00:22, 58.67s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_graph.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  0%|▏                                                    | 3/800 [03:03<14:09:46, 63.97s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_graph.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  2%|▊                                                    | 12/800 [04:15<4:58:03, 22.69s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_graph.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
 25%|█████████████▌                                        | 200/800 [06:03<05:44,  1.74it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 200 ---
 50%|███████████████████████████                           | 400/800 [08:04<03:47,  1.76it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 400 ---
Epoch 0|2: Train Loss (Epoch Mean): 0.785145723298192
/nas/home/ktshim/tool/pool/graphtoken/glm_graph.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_graph.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_graph.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_graph.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_graph.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
Epoch: 0|2: Val Loss: 0.582704348564148
Saving checkpoint at epoch 0 to output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
 75%|████████████████████████████████████████▌             | 600/800 [12:22<01:55,  1.73it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 200 ---
100%|██████████████████████████████████████████████████████| 800/800 [14:21<00:00,  1.79it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 400 ---
Epoch 1|2: Train Loss (Epoch Mean): 0.5660561164468527
Epoch: 1|2: Val Loss: 0.5573022389411926
Saving checkpoint at epoch 1 to output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
/home/ktshim/anaconda3/envs/tool/lib/python3.9/site-packages/torch/cuda/memory.py:489: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
Loading checkpoint from output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
                                                                                                                               Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  0%|                                                                                                   | 0/84 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  1%|█                                                                                          | 1/84 [00:05<07:41,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  2%|██▏                                                                                        | 2/84 [00:11<07:35,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  4%|███▎                                                                                       | 3/84 [00:16<07:30,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  5%|████▎                                                                                      | 4/84 [00:22<07:25,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  6%|█████▍                                                                                     | 5/84 [00:27<07:19,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  7%|██████▌                                                                                    | 6/84 [00:33<07:13,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  8%|███████▌                                                                                   | 7/84 [00:38<07:08,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 10%|████████▋                                                                                  | 8/84 [00:44<07:02,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 11%|█████████▊                                                                                 | 9/84 [00:50<06:57,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 12%|██████████▋                                                                               | 10/84 [00:55<06:51,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 13%|███████████▊                                                                              | 11/84 [01:01<06:46,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 14%|████████████▊                                                                             | 12/84 [01:06<06:40,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 15%|█████████████▉                                                                            | 13/84 [01:12<06:34,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 17%|███████████████                                                                           | 14/84 [01:17<06:29,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 18%|████████████████                                                                          | 15/84 [01:23<06:23,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 19%|█████████████████▏                                                                        | 16/84 [01:28<06:18,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 20%|██████████████████▏                                                                       | 17/84 [01:34<06:12,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 21%|███████████████████▎                                                                      | 18/84 [01:40<06:06,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 23%|████████████████████▎                                                                     | 19/84 [01:45<06:01,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 24%|█████████████████████▍                                                                    | 20/84 [01:51<05:55,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 25%|██████████████████████▌                                                                   | 21/84 [01:56<05:50,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 26%|███████████████████████▌                                                                  | 22/84 [02:02<05:44,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 27%|████████████████████████▋                                                                 | 23/84 [02:07<05:39,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 29%|█████████████████████████▋                                                                | 24/84 [02:13<05:33,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 30%|██████████████████████████▊                                                               | 25/84 [02:19<05:28,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 31%|███████████████████████████▊                                                              | 26/84 [02:24<05:22,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 32%|████████████████████████████▉                                                             | 27/84 [02:30<05:16,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 33%|██████████████████████████████                                                            | 28/84 [02:35<05:11,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 35%|███████████████████████████████                                                           | 29/84 [02:41<05:05,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 36%|████████████████████████████████▏                                                         | 30/84 [02:46<05:00,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 37%|█████████████████████████████████▏                                                        | 31/84 [02:52<04:54,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 38%|██████████████████████████████████▎                                                       | 32/84 [02:57<04:49,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 39%|███████████████████████████████████▎                                                      | 33/84 [03:03<04:43,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 40%|████████████████████████████████████▍                                                     | 34/84 [03:09<04:38,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 42%|█████████████████████████████████████▌                                                    | 35/84 [03:14<04:32,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 43%|██████████████████████████████████████▌                                                   | 36/84 [03:20<04:26,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 44%|███████████████████████████████████████▋                                                  | 37/84 [03:25<04:21,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 45%|████████████████████████████████████████▋                                                 | 38/84 [03:31<04:15,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 46%|█████████████████████████████████████████▊                                                | 39/84 [03:36<04:10,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 48%|██████████████████████████████████████████▊                                               | 40/84 [03:42<04:04,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 49%|███████████████████████████████████████████▉                                              | 41/84 [03:47<03:59,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 50%|█████████████████████████████████████████████                                             | 42/84 [03:53<03:53,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 51%|██████████████████████████████████████████████                                            | 43/84 [03:59<03:47,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 52%|███████████████████████████████████████████████▏                                          | 44/84 [04:04<03:42,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 54%|████████████████████████████████████████████████▏                                         | 45/84 [04:10<03:36,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 55%|█████████████████████████████████████████████████▎                                        | 46/84 [04:15<03:31,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 56%|██████████████████████████████████████████████████▎                                       | 47/84 [04:21<03:25,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 57%|███████████████████████████████████████████████████▍                                      | 48/84 [04:26<03:20,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 58%|████████████████████████████████████████████████████▌                                     | 49/84 [04:32<03:14,  5.55s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 60%|█████████████████████████████████████████████████████▌                                    | 50/84 [04:37<03:08,  5.55s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 61%|██████████████████████████████████████████████████████▋                                   | 51/84 [04:43<03:03,  5.55s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 62%|███████████████████████████████████████████████████████▋                                  | 52/84 [04:49<02:57,  5.55s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 63%|████████████████████████████████████████████████████████▊                                 | 53/84 [04:54<02:52,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 64%|█████████████████████████████████████████████████████████▊                                | 54/84 [05:00<02:46,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 65%|██████████████████████████████████████████████████████████▉                               | 55/84 [05:05<02:41,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 67%|████████████████████████████████████████████████████████████                              | 56/84 [05:11<02:35,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 68%|█████████████████████████████████████████████████████████████                             | 57/84 [05:16<02:30,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 69%|██████████████████████████████████████████████████████████████▏                           | 58/84 [05:22<02:24,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 70%|███████████████████████████████████████████████████████████████▏                          | 59/84 [05:28<02:18,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 71%|████████████████████████████████████████████████████████████████▎                         | 60/84 [05:33<02:13,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 73%|█████████████████████████████████████████████████████████████████▎                        | 61/84 [05:39<02:07,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 74%|██████████████████████████████████████████████████████████████████▍                       | 62/84 [05:44<02:02,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 75%|███████████████████████████████████████████████████████████████████▌                      | 63/84 [05:50<01:56,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 76%|████████████████████████████████████████████████████████████████████▌                     | 64/84 [05:55<01:51,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 77%|█████████████████████████████████████████████████████████████████████▋                    | 65/84 [06:01<01:45,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 79%|██████████████████████████████████████████████████████████████████████▋                   | 66/84 [06:06<01:40,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 80%|███████████████████████████████████████████████████████████████████████▊                  | 67/84 [06:12<01:34,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 81%|████████████████████████████████████████████████████████████████████████▊                 | 68/84 [06:18<01:28,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 82%|█████████████████████████████████████████████████████████████████████████▉                | 69/84 [06:23<01:23,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 83%|███████████████████████████████████████████████████████████████████████████               | 70/84 [06:29<01:17,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 85%|████████████████████████████████████████████████████████████████████████████              | 71/84 [06:34<01:12,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 86%|█████████████████████████████████████████████████████████████████████████████▏            | 72/84 [06:40<01:06,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 87%|██████████████████████████████████████████████████████████████████████████████▏           | 73/84 [06:45<01:01,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 88%|███████████████████████████████████████████████████████████████████████████████▎          | 74/84 [06:51<00:55,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 89%|████████████████████████████████████████████████████████████████████████████████▎         | 75/84 [06:56<00:50,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 90%|█████████████████████████████████████████████████████████████████████████████████▍        | 76/84 [07:02<00:44,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 92%|██████████████████████████████████████████████████████████████████████████████████▌       | 77/84 [07:08<00:38,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 93%|███████████████████████████████████████████████████████████████████████████████████▌      | 78/84 [07:13<00:33,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 94%|████████████████████████████████████████████████████████████████████████████████████▋     | 79/84 [07:19<00:27,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 95%|█████████████████████████████████████████████████████████████████████████████████████▋    | 80/84 [07:24<00:22,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 96%|██████████████████████████████████████████████████████████████████████████████████████▊   | 81/84 [07:30<00:16,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 98%|███████████████████████████████████████████████████████████████████████████████████████▊  | 82/84 [07:35<00:11,  5.56s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 99%|████████████████████████████████████████████████████████████████████████████████████████▉ | 83/84 [07:41<00:05,  5.56s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████| 84/84 [07:46<00:00,  5.49s/it]

## Finishing Time: 09-12 17:32:00
= = = = = = = = = = = = = = = = = = = =
Done!
