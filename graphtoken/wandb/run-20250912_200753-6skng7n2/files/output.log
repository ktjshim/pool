= = = = = = = = = = = = = = = = = = = =
## Starting Time: 09-12 19:07:54
Namespace(dataset='ultratool', llm='Mistral-7B', llm_model_path='', seed=0, device='cuda:0', max_txt_length=512, max_ans_length=512, gnn_in_dim=1024, gnn_hidden_dim=1024, gnn_output_dim=4096, n_layers=2, gnn_type='SAGE', max_degree=270, max_nodes=270, num_epochs=2, batch_size=6, eval_batch_size=6, patience=2, lr=1e-05, wd=0.05, output_dir='output', grad_steps=4, name='centrality_fp32')

[Training Data] # Chain Samples 3000 (100.00)
[Data Split] # Train 3000  # Test 500
# Train 2400   # Val 600   # Test 500
Loading checkpoint shards: 100%|█████████████████████████████████████| 3/3 [00:01<00:00,  2.01it/s]
Finish loading pre-trained Mistral-7B model!
Trainable params 12704768 || all params 7254436864 || trainable% 0.17513
/nas/home/ktshim/tool/pool/graphtoken/../utils/datautil.py:24: RuntimeWarning: divide by zero encountered in power
  d_inv = np.power(row_sum, -0.5).flatten()
/nas/home/ktshim/tool/pool/graphtoken/../utils/datautil.py:19: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:654.)
  return torch.sparse.FloatTensor(index, data, torch.Size(coo.shape))
  0%|                                                                      | 0/800 [00:00<?, ?it/s]/home/ktshim/anaconda3/envs/tool/lib/python3.9/site-packages/torch/_inductor/compile_fx.py:236: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/nas/home/ktshim/tool/pool/graphtoken/glm_node_centrality.py:83: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  0%|                                                           | 1/800 [00:45<10:01:53, 45.20s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node_centrality.py:83: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  0%|▏                                                          | 2/800 [01:52<12:55:30, 58.31s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node_centrality.py:83: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  0%|▎                                                          | 4/800 [03:03<10:23:29, 47.00s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node_centrality.py:83: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  5%|███                                                        | 41/800 [04:39<4:25:03, 20.95s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node_centrality.py:83: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
 25%|███████████████                                             | 200/800 [06:47<08:04,  1.24it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 200 ---
 50%|██████████████████████████████                              | 400/800 [09:34<05:22,  1.24it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 400 ---
Epoch 0|2: Train Loss (Epoch Mean): 1.0509483236819506
/nas/home/ktshim/tool/pool/graphtoken/glm_node_centrality.py:83: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_node_centrality.py:83: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_node_centrality.py:83: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_node_centrality.py:83: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_node_centrality.py:83: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
Epoch: 0|2: Val Loss: 0.6807270395755768
Saving checkpoint at epoch 0 to output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
 75%|█████████████████████████████████████████████               | 600/800 [14:08<02:39,  1.26it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 200 ---
100%|████████████████████████████████████████████████████████████| 800/800 [16:56<00:00,  1.24it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 400 ---
Epoch 1|2: Train Loss (Epoch Mean): 0.6428763739019633
Epoch: 1|2: Val Loss: 0.6226475641131402
Saving checkpoint at epoch 1 to output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
/home/ktshim/anaconda3/envs/tool/lib/python3.9/site-packages/torch/cuda/memory.py:489: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
Loading checkpoint from output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
                                                                                                   Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  0%|                                                                       | 0/84 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  1%|▊                                                              | 1/84 [00:06<08:28,  6.12s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  2%|█▌                                                             | 2/84 [00:12<08:18,  6.07s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  4%|██▎                                                            | 3/84 [00:18<08:10,  6.06s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  5%|███                                                            | 4/84 [00:24<08:04,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  6%|███▊                                                           | 5/84 [00:30<07:57,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  7%|████▌                                                          | 6/84 [00:36<07:51,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  8%|█████▎                                                         | 7/84 [00:42<07:45,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 10%|██████                                                         | 8/84 [00:48<07:39,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 11%|██████▊                                                        | 9/84 [00:54<07:33,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 12%|███████▍                                                      | 10/84 [01:00<07:27,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 13%|████████                                                      | 11/84 [01:06<07:21,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 14%|████████▊                                                     | 12/84 [01:12<07:15,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 15%|█████████▌                                                    | 13/84 [01:18<07:09,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 17%|██████████▎                                                   | 14/84 [01:24<07:03,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 18%|███████████                                                   | 15/84 [01:30<06:57,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 19%|███████████▊                                                  | 16/84 [01:36<06:50,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 20%|████████████▌                                                 | 17/84 [01:42<06:45,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 21%|█████████████▎                                                | 18/84 [01:48<06:39,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 23%|██████████████                                                | 19/84 [01:54<06:33,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 24%|██████████████▊                                               | 20/84 [02:00<06:27,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 25%|███████████████▌                                              | 21/84 [02:07<06:21,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 26%|████████████████▏                                             | 22/84 [02:13<06:15,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 27%|████████████████▉                                             | 23/84 [02:19<06:09,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 29%|█████████████████▋                                            | 24/84 [02:25<06:03,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 30%|██████████████████▍                                           | 25/84 [02:31<05:56,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 31%|███████████████████▏                                          | 26/84 [02:37<05:50,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 32%|███████████████████▉                                          | 27/84 [02:43<05:44,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 33%|████████████████████▋                                         | 28/84 [02:49<05:38,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 35%|█████████████████████▍                                        | 29/84 [02:55<05:33,  6.06s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 36%|██████████████████████▏                                       | 30/84 [03:01<05:27,  6.06s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 37%|██████████████████████▉                                       | 31/84 [03:07<05:21,  6.06s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 38%|███████████████████████▌                                      | 32/84 [03:13<05:15,  6.07s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 39%|████████████████████████▎                                     | 33/84 [03:19<05:09,  6.06s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 40%|█████████████████████████                                     | 34/84 [03:25<05:02,  6.06s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 42%|█████████████████████████▊                                    | 35/84 [03:31<04:56,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 43%|██████████████████████████▌                                   | 36/84 [03:37<04:50,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 44%|███████████████████████████▎                                  | 37/84 [03:43<04:44,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 45%|████████████████████████████                                  | 38/84 [03:49<04:38,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 46%|████████████████████████████▊                                 | 39/84 [03:56<04:32,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 48%|█████████████████████████████▌                                | 40/84 [04:02<04:26,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 49%|██████████████████████████████▎                               | 41/84 [04:08<04:20,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 50%|███████████████████████████████                               | 42/84 [04:14<04:14,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 51%|███████████████████████████████▋                              | 43/84 [04:20<04:08,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 52%|████████████████████████████████▍                             | 44/84 [04:26<04:01,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 54%|█████████████████████████████████▏                            | 45/84 [04:32<03:55,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 55%|█████████████████████████████████▉                            | 46/84 [04:38<03:49,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 56%|██████████████████████████████████▋                           | 47/84 [04:44<03:43,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 57%|███████████████████████████████████▍                          | 48/84 [04:50<03:37,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 58%|████████████████████████████████████▏                         | 49/84 [04:56<03:31,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 60%|████████████████████████████████████▉                         | 50/84 [05:02<03:25,  6.06s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 61%|█████████████████████████████████████▋                        | 51/84 [05:08<03:19,  6.06s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 62%|██████████████████████████████████████▍                       | 52/84 [05:14<03:13,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 63%|███████████████████████████████████████                       | 53/84 [05:20<03:07,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 64%|███████████████████████████████████████▊                      | 54/84 [05:26<03:01,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 65%|████████████████████████████████████████▌                     | 55/84 [05:32<02:55,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 67%|█████████████████████████████████████████▎                    | 56/84 [05:38<02:49,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 68%|██████████████████████████████████████████                    | 57/84 [05:44<02:43,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 69%|██████████████████████████████████████████▊                   | 58/84 [05:50<02:37,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 70%|███████████████████████████████████████████▌                  | 59/84 [05:57<02:31,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 71%|████████████████████████████████████████████▎                 | 60/84 [06:03<02:25,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 73%|█████████████████████████████████████████████                 | 61/84 [06:09<02:19,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 74%|█████████████████████████████████████████████▊                | 62/84 [06:15<02:13,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 75%|██████████████████████████████████████████████▌               | 63/84 [06:21<02:06,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 76%|███████████████████████████████████████████████▏              | 64/84 [06:27<02:00,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 77%|███████████████████████████████████████████████▉              | 65/84 [06:33<01:54,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 79%|████████████████████████████████████████████████▋             | 66/84 [06:39<01:48,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 80%|█████████████████████████████████████████████████▍            | 67/84 [06:45<01:42,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 81%|██████████████████████████████████████████████████▏           | 68/84 [06:51<01:36,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 82%|██████████████████████████████████████████████████▉           | 69/84 [06:57<01:30,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 83%|███████████████████████████████████████████████████▋          | 70/84 [07:03<01:24,  6.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 85%|████████████████████████████████████████████████████▍         | 71/84 [07:09<01:18,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 86%|█████████████████████████████████████████████████████▏        | 72/84 [07:15<01:12,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 87%|█████████████████████████████████████████████████████▉        | 73/84 [07:21<01:06,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 88%|██████████████████████████████████████████████████████▌       | 74/84 [07:27<01:00,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 89%|███████████████████████████████████████████████████████▎      | 75/84 [07:33<00:54,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 90%|████████████████████████████████████████████████████████      | 76/84 [07:39<00:48,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 92%|████████████████████████████████████████████████████████▊     | 77/84 [07:45<00:42,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 93%|█████████████████████████████████████████████████████████▌    | 78/84 [07:51<00:36,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 94%|██████████████████████████████████████████████████████████▎   | 79/84 [07:58<00:30,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 95%|███████████████████████████████████████████████████████████   | 80/84 [08:04<00:24,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 96%|███████████████████████████████████████████████████████████▊  | 81/84 [08:10<00:18,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 98%|████████████████████████████████████████████████████████████▌ | 82/84 [08:16<00:12,  6.05s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 99%|█████████████████████████████████████████████████████████████▎| 83/84 [08:22<00:06,  6.05s/it]
100%|██████████████████████████████████████████████████████████████| 84/84 [08:27<00:00,  5.94s/it]

## Finishing Time: 09-12 19:34:07
= = = = = = = = = = = = = = = = = = = =
Done!
