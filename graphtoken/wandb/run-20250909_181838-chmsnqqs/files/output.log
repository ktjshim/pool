= = = = = = = = = = = = = = = = = = = =
## Starting Time: 09-09 17:18:39
Namespace(dataset='ultratool', llm='Mistral-7B', llm_model_path='', seed=0, device='cuda:0', max_txt_length=512, max_ans_length=512, gnn_in_dim=1024, gnn_hidden_dim=1024, gnn_output_dim=4096, n_layers=2, gnn_type='SAGE', max_degree=300, num_epochs=2, batch_size=6, eval_batch_size=6, patience=2, lr=1e-05, wd=0.05, output_dir='output', grad_steps=4, name='node')

[Training Data] # Chain Samples 3000 (100.00)
[Data Split] # Train 3000  # Test 500
# Train 2400   # Val 600   # Test 500
Loading checkpoint shards: 100%|██| 3/3 [00:01<00:00,  2.14it/s]
Finish loading pre-trained Mistral-7B model!
Trainable params 10492928 || all params 7252225024 || trainable% 0.14469
/nas/home/ktshim/tool/pool/graphtoken/../utils/datautil.py:24: RuntimeWarning: divide by zero encountered in power
  d_inv = np.power(row_sum, -0.5).flatten()
/nas/home/ktshim/tool/pool/graphtoken/../utils/datautil.py:19: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:653.)
  return torch.sparse.FloatTensor(index, data, torch.Size(coo.shape))
  0%|                                   | 0/800 [00:00<?, ?it/s]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  0%|                         | 1/800 [00:39<8:49:33, 39.77s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  0%|                        | 2/800 [01:37<11:09:10, 50.31s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  0%|                         | 3/800 [01:38<6:08:21, 27.73s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  0%|▏                        | 4/800 [01:39<3:47:07, 17.12s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  1%|▏                        | 5/800 [01:39<2:28:58, 11.24s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  1%|▏                        | 6/800 [01:40<1:41:52,  7.70s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  1%|▏                        | 7/800 [01:41<1:12:08,  5.46s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  1%|▎                          | 8/800 [01:42<52:39,  3.99s/it]W0909 18:20:25.890000 3558037 torch/_dynamo/convert_frame.py:1016] [0/8] torch._dynamo hit config.recompile_limit (8)
W0909 18:20:25.890000 3558037 torch/_dynamo/convert_frame.py:1016] [0/8]    function: 'forward' (/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:82)
W0909 18:20:25.890000 3558037 torch/_dynamo/convert_frame.py:1016] [0/8]    last reason: 0/7: samples['request'][0] == '# TASK LIST #:\norder_tracking, search_repair_provider, send_sms, special_vehicle_rental_service, search_agenda, menu_select_api, manage_schedule, detailed_inquiry, schedule_planner, appliance_repair_cancellation, flight_status_tracker, read_agenda, hotel_booking_query, import_schedule, travel_plan_maker, del_transaction, search_restaurants, train_ticket_query, foreign_currency_exchange, daily_schedule_manager, product_catalog_search, online_appointment_booking, academic_paper_search, book_meeting_room, loan_info_entry, smart_home_control, car_rental_cancelling, check_meeting_room_availability, train_ticket_booking, agenda_sorting, travel_group_schedule, luggage_check_in, create_document, change_password, souvenir_purchase, get_menu, select_best_hotel, search_conference_rooms, business_trip_ticket_search, flight_info_query, checkout_api, traffic_card, website_design_tool, business_communication, cruise_ticket_search, cruise_ship_booking, souvenir_recommender, company_vehicle_service, create_meeting, restaurant_review, stock_market_trend, health_monitor_tool, search_transactions, check_room_availability, special_personality_test, outward_reception_approval, create_reminder, verify_file_content, conference_room_cancelling, theme_park_info_search, send_document, appliance_repair_status_query, visa_application, calculate_exchange_amount, food_recommendation, virtual_try_on_tool, check_balance, geolocation_tracker, weather_query, rename_file, send_email, file_modify, flight_ticket_cancelling, transfer_money, home_cleaning_booking, online_healing_session, visa_status_check, foreign_currency_sale, postal_code_search, home_cleaning_query, investment_portfolio_builder, flight_status_check, flight_ticket_changing, price_search, set_reminder, special_foreign_currency_purchase, clock_alarm_set, meeting_reservation, travel_insurance_search, sound_effects_tool, edit_agenda, clock_alarm_cancel, flight_status_search, payment_processing, theme_park_ticket_search, special_weather_forecast_tool, check_flight_seats_availability, part_time_job_tool, product_catalog_create, send_ticket, conference_room_query, travel_camera_suggestion, backup_agenda, airport_pickup, product_service_selection, home_cleaning_cancelling, car_rental_booking, file_compression, business_travel_standard_search, travel_journal, event_planning_tool, account_balance_query, appliance_repair_rescheduling, hotel_booking_modification, modify_transaction, route_planning, car_rental_query, table_booking_api, fixed_deposit_transaction, anime_tracking_tool, smart_appliance_control, virtual_classroom_reservation, get_repair_request_id, team_collaboration_tool, asset_checkout_approval, sleep_analysis_tool, open_icbc_messenger_service, parenting_advice_tool, check_file_existence, personal_tax_calculator, create_agenda, car_rental_changing, cash_withdrawal_reservation, internal_purchase, flight_search, notify_user, stock_trend_predictor, send_confirmation, calendar_note, custom_product_service_messenger, travel_camera_rental, login_gear, place_order, search_train, book_restaurant, time_tracker, get_recent_transaction, desktop_organizer, advance_ticket_booking, insurance_customer_update, price_comparison_tool, transport_card_recharge, account_login, insurance_claim_status, tour_group_search, send_business_message, insurance_product_search, credit_card_progress, business_trip_ticket_reservation, send_confirmation_message, news_headlines_generator, login_equipment_check, check_weather, confirm_appointment, calendar_annotation, check_flight_availability, book_flight, hotel_reservation_status, family_interaction_tool, send_meeting_invitations, home_cleaning_changing, merge_orders, file_write, geo_location_finder, theme_park_attractions_search, currency_exchange_rate, ai_search_tool, document_share_tool, create_schedule, check_room_booking_status, advanced_programming_lesson_planner, hotel_booking, internal_person_search, customer_service, network_speedup_tool, email_ma
W0909 18:20:25.890000 3558037 torch/_dynamo/convert_frame.py:1016] [0/8] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W0909 18:20:25.890000 3558037 torch/_dynamo/convert_frame.py:1016] [0/8] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html.
/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
 25%|██████▎                  | 200/800 [04:18<08:04,  1.24it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 200 ---
 50%|████████████▌            | 400/800 [07:19<05:22,  1.24it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 400 ---
Epoch 0|2: Train Loss (Epoch Mean): 1.2475928980112077
Epoch: 0|2: Val Loss: 0.8444917148351669
Saving checkpoint at epoch 0 to output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
 75%|██████████████████▊      | 600/800 [11:00<02:42,  1.23it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 200 ---
100%|█████████████████████████| 800/800 [14:00<00:00,  1.25it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 400 ---
Epoch 1|2: Train Loss (Epoch Mean): 0.7431483787298202
Epoch: 1|2: Val Loss: 0.6579478332400321
Saving checkpoint at epoch 1 to output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
/home/ktshim/.local/lib/python3.12/site-packages/torch/cuda/memory.py:491: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
Loading checkpoint from output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
                                                                Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  0%|                                    | 0/84 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 3186 e pred
[Test Error] Test-ID 1689 e pred
[Test Error] Test-ID 403 e pred
[Test Error] Test-ID 3019 e pred
[Test Error] Test-ID 202 e pred
[Test Error] Test-ID 2624 e pred
  1%|▎                           | 1/84 [00:17<23:49, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 1668 e pred
[Test Error] Test-ID 1183 e pred
[Test Error] Test-ID 2058 e pred
[Test Error] Test-ID 927 e pred
[Test Error] Test-ID 1939 e pred
[Test Error] Test-ID 2104 e pred
  2%|▋                           | 2/84 [00:34<23:31, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 877 e pred
[Test Error] Test-ID 3002 e pred
[Test Error] Test-ID 1546 e pred
[Test Error] Test-ID 900 e pred
[Test Error] Test-ID 585 e pred
[Test Error] Test-ID 42 e pred
  4%|█                           | 3/84 [00:51<23:14, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 974 e pred
[Test Error] Test-ID 1417 e pred
[Test Error] Test-ID 327 e pred
[Test Error] Test-ID 2009 e pred
[Test Error] Test-ID 3117 e pred
[Test Error] Test-ID 1108 e pred
  5%|█▎                          | 4/84 [01:08<22:57, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2103 e pred
[Test Error] Test-ID 801 e pred
[Test Error] Test-ID 2741 e pred
[Test Error] Test-ID 440 e pred
[Test Error] Test-ID 3028 e pred
[Test Error] Test-ID 603 e pred
  6%|█▋                          | 5/84 [01:26<22:40, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2968 e pred
[Test Error] Test-ID 1441 e pred
[Test Error] Test-ID 869 e pred
[Test Error] Test-ID 1639 e pred
[Test Error] Test-ID 97 e pred
[Test Error] Test-ID 3198 e pred
  7%|██                          | 6/84 [01:43<22:23, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2475 e pred
[Test Error] Test-ID 1184 e pred
[Test Error] Test-ID 2340 e pred
[Test Error] Test-ID 976 e pred
[Test Error] Test-ID 1067 e pred
[Test Error] Test-ID 1559 e pred
  8%|██▎                         | 7/84 [02:00<22:05, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 1480 e pred
[Test Error] Test-ID 152 e pred
[Test Error] Test-ID 870 e pred
[Test Error] Test-ID 2990 e pred
[Test Error] Test-ID 387 e pred
[Test Error] Test-ID 708 e pred
 10%|██▋                         | 8/84 [02:17<21:48, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2347 e pred
[Test Error] Test-ID 2179 e pred
[Test Error] Test-ID 1210 e pred
[Test Error] Test-ID 126 e pred
[Test Error] Test-ID 1812 e pred
[Test Error] Test-ID 1810 e pred
 11%|███                         | 9/84 [02:34<21:31, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 1006 e pred
[Test Error] Test-ID 2735 e pred
[Test Error] Test-ID 1391 e pred
[Test Error] Test-ID 506 e pred
[Test Error] Test-ID 3128 e pred
[Test Error] Test-ID 3164 e pred
 12%|███▏                       | 10/84 [02:52<21:14, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2294 e pred
[Test Error] Test-ID 3435 e pred
[Test Error] Test-ID 2071 e pred
[Test Error] Test-ID 2368 e pred
[Test Error] Test-ID 1836 e pred
[Test Error] Test-ID 2440 e pred
 13%|███▌                       | 11/84 [03:09<20:56, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 1792 e pred
[Test Error] Test-ID 788 e pred
[Test Error] Test-ID 455 e pred
[Test Error] Test-ID 2400 e pred
[Test Error] Test-ID 2673 e pred
[Test Error] Test-ID 2745 e pred
 14%|███▊                       | 12/84 [03:26<20:39, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 3101 e pred
[Test Error] Test-ID 856 e pred
[Test Error] Test-ID 1097 e pred
[Test Error] Test-ID 2075 e pred
[Test Error] Test-ID 1200 e pred
[Test Error] Test-ID 2886 e pred
 15%|████▏                      | 13/84 [03:43<20:22, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 1188 e pred
[Test Error] Test-ID 680 e pred
[Test Error] Test-ID 1882 e pred
[Test Error] Test-ID 2706 e pred
[Test Error] Test-ID 3029 e pred
[Test Error] Test-ID 2721 e pred
 17%|████▌                      | 14/84 [04:01<20:05, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2010 e pred
[Test Error] Test-ID 1661 e pred
[Test Error] Test-ID 2169 e pred
[Test Error] Test-ID 186 e pred
[Test Error] Test-ID 398 e pred
[Test Error] Test-ID 1486 e pred
 18%|████▊                      | 15/84 [04:18<19:48, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 1703 e pred
[Test Error] Test-ID 660 e pred
[Test Error] Test-ID 2413 e pred
[Test Error] Test-ID 2940 e pred
[Test Error] Test-ID 20 e pred
[Test Error] Test-ID 1636 e pred
 19%|█████▏                     | 16/84 [04:35<19:30, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2460 e pred
[Test Error] Test-ID 2800 e pred
[Test Error] Test-ID 3358 e pred
[Test Error] Test-ID 2485 e pred
[Test Error] Test-ID 2316 e pred
[Test Error] Test-ID 2328 e pred
 20%|█████▍                     | 17/84 [04:52<19:13, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 3226 e pred
[Test Error] Test-ID 3362 e pred
[Test Error] Test-ID 1012 e pred
[Test Error] Test-ID 1422 e pred
[Test Error] Test-ID 2883 e pred
[Test Error] Test-ID 2520 e pred
 21%|█████▊                     | 18/84 [05:09<18:56, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2539 e pred
[Test Error] Test-ID 1980 e pred
[Test Error] Test-ID 452 e pred
[Test Error] Test-ID 1291 e pred
[Test Error] Test-ID 2607 e pred
[Test Error] Test-ID 535 e pred
 23%|██████                     | 19/84 [05:27<18:39, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2445 e pred
[Test Error] Test-ID 2049 e pred
[Test Error] Test-ID 1438 e pred
[Test Error] Test-ID 668 e pred
[Test Error] Test-ID 1888 e pred
[Test Error] Test-ID 3098 e pred
 24%|██████▍                    | 20/84 [05:44<18:21, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2430 e pred
[Test Error] Test-ID 3218 e pred
[Test Error] Test-ID 396 e pred
[Test Error] Test-ID 522 e pred
[Test Error] Test-ID 266 e pred
[Test Error] Test-ID 2448 e pred
 25%|██████▊                    | 21/84 [06:01<18:04, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 119 e pred
[Test Error] Test-ID 3527 e pred
[Test Error] Test-ID 3295 e pred
[Test Error] Test-ID 1823 e pred
[Test Error] Test-ID 1579 e pred
[Test Error] Test-ID 1007 e pred
 26%|███████                    | 22/84 [06:18<17:47, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2670 e pred
[Test Error] Test-ID 1117 e pred
[Test Error] Test-ID 1533 e pred
[Test Error] Test-ID 2066 e pred
[Test Error] Test-ID 659 e pred
[Test Error] Test-ID 210 e pred
 27%|███████▍                   | 23/84 [06:36<17:30, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 3237 e pred
[Test Error] Test-ID 863 e pred
[Test Error] Test-ID 2964 e pred
[Test Error] Test-ID 1801 e pred
[Test Error] Test-ID 2158 e pred
[Test Error] Test-ID 699 e pred
 29%|███████▋                   | 24/84 [06:53<17:13, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2338 e pred
[Test Error] Test-ID 2871 e pred
[Test Error] Test-ID 616 e pred
[Test Error] Test-ID 222 e pred
[Test Error] Test-ID 2966 e pred
[Test Error] Test-ID 2666 e pred
 30%|████████                   | 25/84 [07:10<16:55, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 3433 e pred
[Test Error] Test-ID 2891 e pred
[Test Error] Test-ID 351 e pred
[Test Error] Test-ID 652 e pred
[Test Error] Test-ID 1395 e pred
[Test Error] Test-ID 19 e pred
 31%|████████▎                  | 26/84 [07:27<16:38, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 936 e pred
[Test Error] Test-ID 1518 e pred
[Test Error] Test-ID 2425 e pred
[Test Error] Test-ID 2768 e pred
[Test Error] Test-ID 2180 e pred
[Test Error] Test-ID 175 e pred
 32%|████████▋                  | 27/84 [07:44<16:21, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 3152 e pred
[Test Error] Test-ID 1247 e pred
[Test Error] Test-ID 2644 e pred
[Test Error] Test-ID 2577 e pred
[Test Error] Test-ID 3283 e pred
[Test Error] Test-ID 1607 e pred
 33%|█████████                  | 28/84 [08:02<16:04, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2371 e pred
[Test Error] Test-ID 2775 e pred
[Test Error] Test-ID 2613 e pred
[Test Error] Test-ID 1506 e pred
[Test Error] Test-ID 1315 e pred
[Test Error] Test-ID 1344 e pred
 35%|█████████▎                 | 29/84 [08:19<15:46, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 1172 e pred
[Test Error] Test-ID 1530 e pred
[Test Error] Test-ID 447 e pred
[Test Error] Test-ID 3468 e pred
[Test Error] Test-ID 2086 e pred
[Test Error] Test-ID 525 e pred
 36%|█████████▋                 | 30/84 [08:36<15:29, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2524 e pred
[Test Error] Test-ID 2498 e pred
[Test Error] Test-ID 2606 e pred
[Test Error] Test-ID 1770 e pred
[Test Error] Test-ID 2432 e pred
[Test Error] Test-ID 1336 e pred
 37%|█████████▉                 | 31/84 [08:53<15:12, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2163 e pred
[Test Error] Test-ID 2243 e pred
[Test Error] Test-ID 2639 e pred
[Test Error] Test-ID 289 e pred
[Test Error] Test-ID 2132 e pred
[Test Error] Test-ID 553 e pred
 38%|██████████▎                | 32/84 [09:10<14:55, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 399 e pred
[Test Error] Test-ID 2815 e pred
[Test Error] Test-ID 2106 e pred
[Test Error] Test-ID 3111 e pred
[Test Error] Test-ID 3145 e pred
[Test Error] Test-ID 2345 e pred
 39%|██████████▌                | 33/84 [09:28<14:38, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 3536 e pred
[Test Error] Test-ID 846 e pred
[Test Error] Test-ID 785 e pred
[Test Error] Test-ID 1032 e pred
[Test Error] Test-ID 812 e pred
[Test Error] Test-ID 3252 e pred
 40%|██████████▉                | 34/84 [09:45<14:20, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 1120 e pred
[Test Error] Test-ID 378 e pred
[Test Error] Test-ID 615 e pred
[Test Error] Test-ID 1221 e pred
[Test Error] Test-ID 2920 e pred
[Test Error] Test-ID 594 e pred
 42%|███████████▎               | 35/84 [10:02<14:03, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2980 e pred
[Test Error] Test-ID 1212 e pred
[Test Error] Test-ID 920 e pred
[Test Error] Test-ID 1370 e pred
[Test Error] Test-ID 434 e pred
[Test Error] Test-ID 310 e pred
 43%|███████████▌               | 36/84 [10:19<13:46, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 3313 e pred
[Test Error] Test-ID 2776 e pred
[Test Error] Test-ID 3379 e pred
[Test Error] Test-ID 1223 e pred
[Test Error] Test-ID 3496 e pred
[Test Error] Test-ID 2959 e pred
 44%|███████████▉               | 37/84 [10:37<13:29, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 1637 e pred
[Test Error] Test-ID 3146 e pred
[Test Error] Test-ID 1206 e pred
[Test Error] Test-ID 1013 e pred
[Test Error] Test-ID 1826 e pred
[Test Error] Test-ID 990 e pred
 45%|████████████▏              | 38/84 [10:54<13:11, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 418 e pred
[Test Error] Test-ID 1851 e pred
[Test Error] Test-ID 1472 e pred
[Test Error] Test-ID 733 e pred
[Test Error] Test-ID 1492 e pred
[Test Error] Test-ID 1445 e pred
 46%|████████████▌              | 39/84 [11:11<12:54, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 748 e pred
[Test Error] Test-ID 1806 e pred
[Test Error] Test-ID 385 e pred
[Test Error] Test-ID 1177 e pred
[Test Error] Test-ID 2987 e pred
[Test Error] Test-ID 2270 e pred
 48%|████████████▊              | 40/84 [11:28<12:37, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 2471 e pred
[Test Error] Test-ID 134 e pred
[Test Error] Test-ID 873 e pred
[Test Error] Test-ID 2317 e pred
[Test Error] Test-ID 766 e pred
[Test Error] Test-ID 2252 e pred
 49%|█████████████▏             | 41/84 [11:45<12:20, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 3048 e pred
[Test Error] Test-ID 3076 e pred
[Test Error] Test-ID 2212 e pred
[Test Error] Test-ID 2656 e pred
[Test Error] Test-ID 906 e pred
[Test Error] Test-ID 61 e pred
 50%|█████████████▌             | 42/84 [12:03<12:03, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 970 e pred
[Test Error] Test-ID 3453 e pred
[Test Error] Test-ID 2739 e pred
[Test Error] Test-ID 85 e pred
[Test Error] Test-ID 1709 e pred
[Test Error] Test-ID 2682 e pred
 51%|█████████████▊             | 43/84 [12:20<11:45, 17.21s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 205 e pred
[Test Error] Test-ID 377 e pred
[Test Error] Test-ID 1209 e pred
[Test Error] Test-ID 1103 e pred
[Test Error] Test-ID 391 e pred
[Test Error] Test-ID 239 e pred
 52%|██████████████▏            | 44/84 [12:37<11:28, 17.21s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 3001 e pred
[Test Error] Test-ID 1950 e pred
[Test Error] Test-ID 3199 e pred
[Test Error] Test-ID 1491 e pred
[Test Error] Test-ID 2810 e pred
[Test Error] Test-ID 17 e pred
 54%|██████████████▍            | 45/84 [12:54<11:11, 17.21s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 77 e pred
[Test Error] Test-ID 1539 e pred
[Test Error] Test-ID 1870 e pred
[Test Error] Test-ID 2515 e pred
[Test Error] Test-ID 3470 e pred
[Test Error] Test-ID 2381 e pred
 55%|██████████████▊            | 46/84 [13:11<10:54, 17.22s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[Test Error] Test-ID 1262 e pred
[Test Error] Test-ID 293 e pred
[Test Error] Test-ID 500 e pred
[Test Error] Test-ID 1149 e pred
[Test Error] Test-ID 2191 e pred
[Test Error] Test-ID 3110 e pred
Traceback (most recent call last):47/84 [13:29<10:37, 17.22s/it]
  File "/nas/home/ktshim/tool/pool/graphtoken/main.py", line 210, in <module>
    id_list, predictions, requests = model.inference(batch, task_graph)
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas/home/ktshim/tool/pool/graphtoken/glm_node.py", line 163, in inference
    outputs = self.model.generate(
              ^^^^^^^^^^^^^^^^^^^^
  File "/home/ktshim/.local/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ktshim/.local/lib/python3.12/site-packages/transformers/generation/utils.py", line 2617, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/home/ktshim/.local/lib/python3.12/site-packages/transformers/generation/utils.py", line 3589, in _sample
    while self._has_unfinished_sequences(this_peer_finished, synced_gpus, device=input_ids.device):
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
