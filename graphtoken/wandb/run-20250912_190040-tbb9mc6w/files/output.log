= = = = = = = = = = = = = = = = = = = =
## Starting Time: 09-12 18:00:41
Namespace(dataset='ultratool', llm='Mistral-7B', llm_model_path='', seed=0, device='cuda:0', max_txt_length=512, max_ans_length=512, gnn_in_dim=1024, gnn_hidden_dim=1024, gnn_output_dim=4096, n_layers=2, gnn_type='SAGE', max_degree=300, max_nodes=23, num_epochs=2, batch_size=6, eval_batch_size=6, patience=2, lr=1e-05, wd=0.05, output_dir='output', grad_steps=4, name='node_fp32')

[Training Data] # Chain Samples 3000 (100.00)
[Data Split] # Train 3000  # Test 500
# Train 2400   # Val 600   # Test 500
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████| 3/3 [00:01<00:00,  2.09it/s]
Finish loading pre-trained Mistral-7B model!
Trainable params 10492928 || all params 7252225024 || trainable% 0.14469
/nas/home/ktshim/tool/pool/graphtoken/../utils/datautil.py:24: RuntimeWarning: divide by zero encountered in power
  d_inv = np.power(row_sum, -0.5).flatten()
/nas/home/ktshim/tool/pool/graphtoken/../utils/datautil.py:19: UserWarning: torch.sparse.SparseTensor(indices, values, shape, *, device=) is deprecated.  Please use torch.sparse_coo_tensor(indices, values, shape, dtype=, device=). (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:654.)
  return torch.sparse.FloatTensor(index, data, torch.Size(coo.shape))
  0%|                                                                                        | 0/800 [00:00<?, ?it/s]/home/ktshim/anaconda3/envs/tool/lib/python3.9/site-packages/torch/_inductor/compile_fx.py:236: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  0%|                                                                              | 1/800 [00:43<9:41:44, 43.68s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  0%|▏                                                                            | 2/800 [01:51<12:47:30, 57.71s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  0%|▍                                                                            | 4/800 [02:59<10:08:47, 45.89s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
  1%|▌                                                                             | 6/800 [04:10<9:33:55, 43.37s/it]/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
 25%|███████████████████▌                                                          | 200/800 [06:46<07:58,  1.25it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 200 ---
 50%|███████████████████████████████████████                                       | 400/800 [09:35<05:17,  1.26it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 400 ---
Epoch 0|2: Train Loss (Epoch Mean): 0.9306894017010927
/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
/nas/home/ktshim/tool/pool/graphtoken/glm_node.py:78: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return torch.cuda.amp.autocast(dtype=dtype)
Epoch: 0|2: Val Loss: 0.6130434894561767
Saving checkpoint at epoch 0 to output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
 75%|██████████████████████████████████████████████████████████▌                   | 600/800 [14:13<02:42,  1.23it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 200 ---
100%|██████████████████████████████████████████████████████████████████████████████| 800/800 [17:01<00:00,  1.27it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.

--- Running Inference Check at Step 400 ---
Epoch 1|2: Train Loss (Epoch Mean): 0.5771248105168343
Epoch: 1|2: Val Loss: 0.5567592680454254
Saving checkpoint at epoch 1 to output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
/home/ktshim/anaconda3/envs/tool/lib/python3.9/site-packages/torch/cuda/memory.py:489: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
Loading checkpoint from output/ultratool/Mistral-7B/SAGE_Epoch2_checkpoint_best.pth
                                                                                                               Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  0%|                                                                                   | 0/84 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  1%|▉                                                                          | 1/84 [00:05<07:01,  5.08s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  2%|█▊                                                                         | 2/84 [00:09<06:42,  4.90s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  4%|██▋                                                                        | 3/84 [00:14<06:32,  4.85s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  5%|███▌                                                                       | 4/84 [00:19<06:25,  4.82s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  6%|████▍                                                                      | 5/84 [00:24<06:19,  4.81s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  7%|█████▎                                                                     | 6/84 [00:28<06:14,  4.80s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
  8%|██████▎                                                                    | 7/84 [00:33<06:08,  4.79s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 10%|███████▏                                                                   | 8/84 [00:38<06:11,  4.88s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 11%|████████                                                                   | 9/84 [00:43<06:03,  4.85s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 12%|████████▊                                                                 | 10/84 [00:48<05:57,  4.83s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 13%|█████████▋                                                                | 11/84 [00:53<05:51,  4.81s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 14%|██████████▌                                                               | 12/84 [00:57<05:45,  4.80s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 15%|███████████▍                                                              | 13/84 [01:02<05:40,  4.80s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 17%|████████████▎                                                             | 14/84 [01:07<05:35,  4.79s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 18%|█████████████▏                                                            | 15/84 [01:12<05:36,  4.88s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 19%|██████████████                                                            | 16/84 [01:17<05:29,  4.85s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 20%|██████████████▉                                                           | 17/84 [01:22<05:29,  4.92s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 21%|███████████████▊                                                          | 18/84 [01:27<05:27,  4.97s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 23%|████████████████▋                                                         | 19/84 [01:32<05:25,  5.00s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 24%|█████████████████▌                                                        | 20/84 [01:37<05:15,  4.93s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 25%|██████████████████▌                                                       | 21/84 [01:42<05:07,  4.89s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 26%|███████████████████▍                                                      | 22/84 [01:47<05:06,  4.94s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 27%|████████████████████▎                                                     | 23/84 [01:52<04:58,  4.89s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 29%|█████████████████████▏                                                    | 24/84 [01:56<04:51,  4.86s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 30%|██████████████████████                                                    | 25/84 [02:01<04:50,  4.92s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 31%|██████████████████████▉                                                   | 26/84 [02:06<04:43,  4.88s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 32%|███████████████████████▊                                                  | 27/84 [02:11<04:41,  4.94s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 33%|████████████████████████▋                                                 | 28/84 [02:16<04:33,  4.89s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 35%|█████████████████████████▌                                                | 29/84 [02:21<04:32,  4.95s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 36%|██████████████████████████▍                                               | 30/84 [02:26<04:24,  4.90s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 37%|███████████████████████████▎                                              | 31/84 [02:31<04:22,  4.95s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 38%|████████████████████████████▏                                             | 32/84 [02:36<04:14,  4.90s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 39%|█████████████████████████████                                             | 33/84 [02:40<04:07,  4.86s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 40%|█████████████████████████████▉                                            | 34/84 [02:46<04:06,  4.93s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 42%|██████████████████████████████▊                                           | 35/84 [02:51<04:03,  4.97s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 43%|███████████████████████████████▋                                          | 36/84 [02:55<03:55,  4.92s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 44%|████████████████████████████████▌                                         | 37/84 [03:01<03:53,  4.96s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 45%|█████████████████████████████████▍                                        | 38/84 [03:05<03:45,  4.91s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 46%|██████████████████████████████████▎                                       | 39/84 [03:10<03:39,  4.87s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 48%|███████████████████████████████████▏                                      | 40/84 [03:15<03:37,  4.93s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 49%|████████████████████████████████████                                      | 41/84 [03:20<03:34,  4.98s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 50%|█████████████████████████████████████                                     | 42/84 [03:25<03:30,  5.01s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 51%|█████████████████████████████████████▉                                    | 43/84 [03:30<03:26,  5.03s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 52%|██████████████████████████████████████▊                                   | 44/84 [03:35<03:18,  4.95s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 54%|███████████████████████████████████████▋                                  | 45/84 [03:40<03:14,  4.99s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 55%|████████████████████████████████████████▌                                 | 46/84 [03:45<03:07,  4.93s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 56%|█████████████████████████████████████████▍                                | 47/84 [03:50<03:03,  4.97s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 57%|██████████████████████████████████████████▎                               | 48/84 [03:55<02:56,  4.91s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 58%|███████████████████████████████████████████▏                              | 49/84 [04:00<02:53,  4.96s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 60%|████████████████████████████████████████████                              | 50/84 [04:05<02:46,  4.91s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 61%|████████████████████████████████████████████▉                             | 51/84 [04:10<02:43,  4.96s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 62%|█████████████████████████████████████████████▊                            | 52/84 [04:15<02:36,  4.91s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 63%|██████████████████████████████████████████████▋                           | 53/84 [04:19<02:30,  4.87s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 64%|███████████████████████████████████████████████▌                          | 54/84 [04:24<02:25,  4.84s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 65%|████████████████████████████████████████████████▍                         | 55/84 [04:29<02:19,  4.82s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 67%|█████████████████████████████████████████████████▎                        | 56/84 [04:34<02:14,  4.81s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 68%|██████████████████████████████████████████████████▏                       | 57/84 [04:39<02:12,  4.89s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 69%|███████████████████████████████████████████████████                       | 58/84 [04:44<02:08,  4.95s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 70%|███████████████████████████████████████████████████▉                      | 59/84 [04:49<02:04,  4.99s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 71%|████████████████████████████████████████████████████▊                     | 60/84 [04:54<02:00,  5.01s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 73%|█████████████████████████████████████████████████████▋                    | 61/84 [04:59<01:54,  4.97s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 74%|██████████████████████████████████████████████████████▌                   | 62/84 [05:04<01:48,  4.91s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 75%|███████████████████████████████████████████████████████▌                  | 63/84 [05:08<01:42,  4.87s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 76%|████████████████████████████████████████████████████████▍                 | 64/84 [05:13<01:36,  4.84s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 77%|█████████████████████████████████████████████████████████▎                | 65/84 [05:18<01:33,  4.91s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 79%|██████████████████████████████████████████████████████████▏               | 66/84 [05:23<01:27,  4.87s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 80%|███████████████████████████████████████████████████████████               | 67/84 [05:28<01:23,  4.93s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 81%|███████████████████████████████████████████████████████████▉              | 68/84 [05:33<01:18,  4.89s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 82%|████████████████████████████████████████████████████████████▊             | 69/84 [05:38<01:12,  4.85s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 83%|█████████████████████████████████████████████████████████████▋            | 70/84 [05:43<01:08,  4.92s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 85%|██████████████████████████████████████████████████████████████▌           | 71/84 [05:48<01:04,  4.97s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 86%|███████████████████████████████████████████████████████████████▍          | 72/84 [05:53<00:58,  4.91s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 87%|████████████████████████████████████████████████████████████████▎         | 73/84 [05:58<00:53,  4.90s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 88%|█████████████████████████████████████████████████████████████████▏        | 74/84 [06:03<00:49,  4.95s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 89%|██████████████████████████████████████████████████████████████████        | 75/84 [06:08<00:44,  4.99s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 90%|██████████████████████████████████████████████████████████████████▉       | 76/84 [06:13<00:40,  5.02s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 92%|███████████████████████████████████████████████████████████████████▊      | 77/84 [06:18<00:34,  4.97s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 93%|████████████████████████████████████████████████████████████████████▋     | 78/84 [06:23<00:30,  5.00s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 94%|█████████████████████████████████████████████████████████████████████▌    | 79/84 [06:28<00:25,  5.02s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 95%|██████████████████████████████████████████████████████████████████████▍   | 80/84 [06:33<00:20,  5.04s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 96%|███████████████████████████████████████████████████████████████████████▎  | 81/84 [06:38<00:14,  4.96s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 98%|████████████████████████████████████████████████████████████████████████▏ | 82/84 [06:42<00:09,  4.91s/it]Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
 99%|█████████████████████████████████████████████████████████████████████████ | 83/84 [06:47<00:04,  4.96s/it]
100%|██████████████████████████████████████████████████████████████████████████| 84/84 [06:52<00:00,  4.81s/it]

## Finishing Time: 09-12 18:25:22
= = = = = = = = = = = = = = = = = = = =
Done!
